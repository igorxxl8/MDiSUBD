CREATE TABLE Faculty(
    id INT NOT NULL, 
    NAME varchar2(30) NOT NULL UNIQUE,
    PRIMARY KEY(id)
);

CREATE TABLE Students(
    id INT NOT NULL,
    last_name VARCHAR2(60) NOT NULL,
    first_name VARCHAR2(30),
    group_id INT,
    PRIMARY KEY(id),
    FOREIGN KEY(group_id) REFERENCES GROUPS(id)  ON DELETE CASCADE
);

CREATE TABLE GROUPS(
    id INT NOT NULL,
    name VARCHAR2(10) NOT NULL,
    head_group INT,
    faculty_id INT NOT NULL,
    PRIMARY KEY(id),
    FOREIGN KEY(faculty_id) REFERENCES Faculty(id) ON DELETE CASCADE,
    FOREIGN KEY(head_group) REFERENCES Students(id)  ON DELETE CASCADE
);

CREATE TABLE Prepods(
    id INT NOT NULL,
    last_name VARCHAR2(120) NOT NULL,
    first_name VARCHAR2(120),
    faculty_id INT NOT NULL,
    PRIMARY KEY(id),
    FOREIGN KEY(faculty_id) REFERENCES Faculty(id) ON DELETE CASCADE
);

CREATE TABLE TYPE_STUDY_LOAD(
    id NUMBER(10,0) NOT NULL,
    name VARCHAR2(120) NOT NULL UNIQUE,
    PRIMARY KEY(id)
);

CREATE TABLE STUDY_LOAD(
    subject_id INT NOT NULL,
    type_study_id NUMBER(10,0) NOT NULL,
    hours INT,
    id CHAR(20) NOT NULL,
    PRIMARY KEY(id),
    FOREIGN KEY(subject_id) REFERENCES Subjects(id)  ON DELETE CASCADE,
    FOREIGN KEY(type_study_id) REFERENCES TYPE_STUDY_LOAD(id)  ON DELETE CASCADE
);

CREATE TABLE LESSONS(
    group_id INT NOT NULL,
    prepod_id INT NOT NULL,
    study_id CHAR(20) NOT NULL,
    PRIMARY KEY(group_id, prepod_id, study_id),
    FOREIGN KEY(group_id) REFERENCES GROUPS(id)  ON DELETE CASCADE,
    FOREIGN KEY(prepod_id) REFERENCES Prepods(id)  ON DELETE CASCADE,
    FOREIGN KEY(study_id) REFERENCES STUDY_LOAD(id)  ON DELETE CASCADE
);

CREATE TABLE RATING(
    id INT NOT NULL,
    DATE DATE NOT NULL,
    val INT,
    student_id INT NOT NULL,
    study_id CHAR(20) NOT NULL,
    prepods_id INT NOT NULL,
    is_absent CHAR(1) DEFAULT 'N',
    PRIMARY KEY(id),
    FOREIGN KEY(student_id) REFERENCES Students(id)  ON DELETE CASCADE,
    FOREIGN KEY(study_id) REFERENCES STUDY_LOAD(id)  ON DELETE CASCADE,
    FOREIGN key(prepods_id) REFERENCES Prepods(id)  ON DELETE CASCADE
);

CREATE TABLE Subjects(
    id NUMBER NOT NULL,
    name VARCHAR2(120) NOT NULL,
    faculty_id INT,
    PRIMARY KEY(id),
    FOREIGN KEY(faculty_id) REFERENCES Faculty(id) ON DELETE CASCADE
);

--4)
INSERT INTO Faculty VALUES(1, 'FKSIS');
INSERT INTO Faculty VALUES(2, 'FITU');

--1)
INSERT INTO GROUPS VALUES(1, '123456', NULL, 1);

--2)
INSERT INTO Students VALUES(1, 'Ivanov', NULL, 1);
INSERT INTO Students VALUES(2, 'Petrov', NULL, 1);

--3)
UPDATE GROUPS
SET head_group = 1
WHERE id = 1;

--5)
INSERT INTO Prepods VALUES(1, 'Vasechkin', NULL, 1);
INSERT INTO Prepods VALUES(2, 'Petechkin', NULL, 2);

--6)
INSERT INTO Subjects VALUES(1, 'Введение в специальность', 1);
INSERT INTO TYPE_STUDY_LOAD VALUES(1, 'Практическое занятие');
INSERT INTO STUDY_LOAD VALUES(1, 1, 60, 1);
INSERT INTO LESSONS VALUES(1, 1, 1);

--7)
INSERT INTO RATING VALUES(1, '11-11-2018', 10, 1, 1, 1, 'N');
INSERT INTO RATING VALUES(2, '11-11-2018', NULL, 2, 1, 1, 'Y');

--8)
INSERT INTO Prepods VALUES(3, 'Nikiforov', NULL, 1);

INSERT INTO Students VALUES(3, 'Medved', NULL, 1);
INSERT INTO Students VALUES(4, 'Zayc', NULL, 1);
INSERT INTO Students VALUES(5, 'Volk', NULL, 1);
INSERT INTO Students VALUES(6, 'Andreev', NULL, 1);
INSERT INTO Students VALUES(7, 'Lex', NULL, 1);

INSERT INTO TYPE_STUDY_LOAD VALUES(2, 'Лабораторная работа');
INSERT INTO TYPE_STUDY_LOAD VALUES(3, 'Лекция');

INSERT INTO Subjects VALUES(2, 'Математика', 2);
INSERT INTO STUDY_LOAD VALUES(2, 1, 160, 2);
INSERT INTO LESSONS VALUES(1, 2, 2);

INSERT INTO RATING VALUES(3, '12-11-2018', 6, 1, 2, 2, 'N');
INSERT INTO RATING VALUES(4, '15-11-2018', NULL, 2, 2, 2, 'Y');
INSERT INTO RATING VALUES(5, '18-11-2018', 9, 1, 2, 2, 'N');

INSERT INTO Subjects VALUES(13, 'Теория электрических цепей', 2);
INSERT INTO STUDY_LOAD VALUES(13, 2, 90, 3);
INSERT INTO LESSONS VALUES(1, 3, 3);

INSERT INTO RATING VALUES(6, '15-11-2018', NULL, 4, 3, 3, 'N');
INSERT INTO RATING VALUES(7, '18-11-2018', NULL, 6, 3, 3, 'N');
INSERT INTO RATING VALUES(8, '20-11-2018', NULL, 3, 3, 3, 'Y');

INSERT INTO Subjects VALUES(43, 'Физика', 1);
INSERT INTO STUDY_LOAD VALUES(43, 1, 120, 4);
INSERT INTO LESSONS VALUES(1, 3, 4);

INSERT INTO RATING VALUES(9, '01-12-2018', 5, 7, 4, 3, 'N');
INSERT INTO RATING VALUES(10, '02-12-2018', 6, 5, 4, 3, 'N');
INSERT INTO RATING VALUES(11, '14-12-2018', 7, 2, 4, 3, 'N');

INSERT INTO Subjects VALUES(50, 'Программирование', 1);
INSERT INTO STUDY_LOAD VALUES(50, 2, 200, 5);
INSERT INTO LESSONS VALUES(1, 2, 5);

INSERT INTO RATING VALUES(12, '11-11-2018', 8, 1, 5, 2, 'Y');
INSERT INTO RATING VALUES(13, '04-12-2018', 8, 6, 5, 2, 'Y');
INSERT INTO RATING VALUES(14, '06-12-2018', NULL, 7, 5, 2, 'Y');

--9
DELETE FROM Faculty;
DELETE FROM GROUPS;
DELETE FROM LESSONS;
DELETE FROM Prepods;
DELETE FROM RATING;
DELETE FROM STUDY_LOAD;
DELETE FROM Students;
DELETE FROM Subjects;
DELETE FROM TYPE_STUDY_LOAD;



